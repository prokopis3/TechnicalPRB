"use strict";function LoginPageCheck(req,res,next){req.isAuthenticated()?res.redirect("/"):res.json({pol:"rest"})}function sendEmail(req,res,next){var emailContainer=req.body;console.log("emailer contact dialog: ",emailContainer),emailgenerator.contactPromise(emailContainer,function(fulfilled){var respond=fulfilled;console.log("\n---\x3e Task Node js contact service: ",respond),res.json(respond)})}function subscribe(req,res,next){var SubCollection=db.collection("subscribers"),Subscriber=req.body;date=new Date,newdate=date.getUTCFullYear()+"-"+(date.getUTCMonth()+1)+"-"+date.getUTCDate()+" "+date.getUTCHours()+":"+date.getUTCMinutes()+":"+date.getUTCSeconds(),userSession=GBRoutines.getUserSession(req,"asdasd"),SubCollection.findOne({email:Subscriber.email},function(err,doc){err&&res.json({error:"Response Error Subscribe Email",errorCode:3}),doc||SubCollection.save({email:Subscriber.email,DateCreated:date,valid:!0,used:!1,userSession:userSession}),res.json({success:"Email subscribed",successCode:3})})}var express=require("express"),router=express.Router(),device=require("express-device"),mongo=require("mongojs"),db=mongo("mongodb://ucrabeksjkigvz9:lijaIRixg4xgEZrBMPKj@brghyzdzarocacc-mongodb.services.clever-cloud.com:27017/brghyzdzarocacc",[],{ssl:!0}),emailgenerator=require("../ServerJavascript/emailer"),auth=function(req,res,next){return next()},GBRoutines=require("../ServerJavascript/GlobalRoutines");db.on("error",function(err){console.log("database error",err)}),db.on("connect",function(){console.log("database connected")}),router.use(device.capture()),router.post("/emails",sendEmail),router.post("/subscribers",subscribe),module.exports=router;